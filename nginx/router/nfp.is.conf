# Configuration file for nfp.is.
# Generated by salt.nfp.is. DO NOT MODIFY

upstream www {
{%- for server, ips in salt['mine.get']('role:www', 'network.ip_addrs', expr_form='grain').items() %}
{%- for ip in ips %}
    server {{ ip }}; #{{server}}
{%- endfor %}
{%- endfor %}
}

server {
    listen 80;
    server_name www.nfp.is;
    return 301 $scheme://nfp.is$request_uri;
}

server {
    listen       80;
    server_name  nfp.is;

    location / {
        proxy_pass http://www;
    }
}

